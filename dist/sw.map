{"version":3,"sources":["log.js","cacheFiles.js","onInstall.js","onActivate.js","getRequestType.js","onFetch.js","index.js"],"names":["FILLER_LENGTH","MAX_PAYLOAD_LENGTH","log","str","payload","filler","repeat","length","console","payloadStr","substr","cacheFiles","before","after","onInstall","e","waitUntil","self","caches","open","cacheName","then","cache","addAll","skipWaiting","catch","err","onActivate","keys","cacheNames","Promise","all","filter","map","delete","clients","claim","urls","getRequestType","url","startsWith","indexOf","onFetch","request","requestType","skipSW","includes","fetch","respondWith","cache_","match","cachedResponse","networkResponse","put","clone","addEventListener"],"mappings":"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","file":"sw.map","sourceRoot":"../../_root/public/sw","sourcesContent":["\nconst FILLER_LENGTH = 55;\nconst MAX_PAYLOAD_LENGTH = 40;\n\nexport function log(str, payload) {\n\n  const filler = '-'.repeat(FILLER_LENGTH - str.length);\n  if (!payload) return console.log(`[SW] ${filler}> ${str}`);\n\n  if (typeof payload !== 'string') return console.log(`[SW] ${filler}> ${str} `, payload);\n\n  if (payload.length < MAX_PAYLOAD_LENGTH) return console.log(`[SW] ${filler}> ${str} `, payload);\n\n  const payloadStr = payload.substr(payload.length - MAX_PAYLOAD_LENGTH, 1000);\n  return console.log(`[SW] ${filler}> ${str} `, payloadStr);\n\n}\n\n\n","\nexport const cacheFiles = {\n\n  before: [\n    './app.js',\n    // '../base-app/app.js',\n    './index.html',\n    '../icons/favicon.ico',\n    'https://fonts.gstatic.com/s/sourcesanspro/v11/6xK3dSBYKcSV-LCoeQqfX1RYOo3qOK7lujVj9w.woff2',\n    // 'https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js',\n  ],\n\n  after: [\n\n    // fonts\n    // 'https://fonts.googleapis.com/css?family=Source+Sans+Pro',\n\n    // icons\n    '../icons/android-chrome-192x192.png',\n    '../icons/android-chrome-256x256.png',\n    '../icons/android-chrome-512x512.png',\n    '../icons/apple-touch-icon-57x57.png',\n    '../icons/apple-touch-icon-60x60.png',\n    '../icons/apple-touch-icon-72x72.png',\n    '../icons/apple-touch-icon-76x76.png',\n    '../icons/apple-touch-icon-114x114.png',\n    '../icons/apple-touch-icon-120x120.png',\n    '../icons/apple-touch-icon-144x144.png',\n    '../icons/apple-touch-icon-152x152.png',\n    '../icons/apple-touch-icon-180x180.png',\n    '../icons/favicon-32x32.png',\n    '../icons/favicon-16x16.png',\n\n    // splash\n    '../splash/iphone5_640x1136.png',\n    '../splash/iphone6_750x1334.png',\n    '../splash/iphonex_1125x2436.png',\n    '../splash/iphoneplus_1242x2208.png',\n    '../splash/iphonexr_828x1792.png',\n    '../splash/iphonexsmax_1242x2688.png',\n    '../splash/ipad_1536x2048.png',\n    '../splash/ipadpro_1668x2224.png',\n    '../splash/ipadpro_1668x2388.png',\n    '../splash/ipadpro_2048x2732.png',\n  ],\n\n};\n\n","\n/* global self */\nimport { log } from './log';\nimport { cacheFiles } from './cacheFiles';\n\nexport function onInstall(e) {\n\n  e.waitUntil(\n    self.caches.open(self.cacheName)\n    .then(cache => {\n      log('Installed', cache);\n      cache.addAll(cacheFiles.after);\n      return cache.addAll(cacheFiles.before);\n    })\n    .then(() => {\n      return self.skipWaiting();\n    })\n    .catch(err => {\n      log('Install: Error', err);\n    })\n  );\n\n}\n","\n/* global self */\nimport { log } from './log';\n\nexport function onActivate(e) {\n\n  e.waitUntil(\n    self.caches.keys()\n    .then(cacheNames => {\n      log('Activated');\n      return Promise.all(\n        cacheNames\n        .filter(cacheName => cacheName !== self.cacheName)\n        .map(cacheName => {\n          log('Removing cached files from ', cacheName);\n          self.caches.delete(cacheName);\n        })\n      );\n    })\n    .then(() => {\n      log('Claiming clients');\n      return self.clients.claim();\n    })\n  );\n}\n\n\n\n","\n\nconst urls = [ 'https://museeker.io', 'http://localhost' ];\n\nexport function getRequestType(url) {\n\n  const isSameOrigin = url.startsWith(urls[0]) || url.startsWith(urls[1]);\n  if (!isSameOrigin) return 'external';\n\n  const isApi = url.indexOf('/api/') >= 0;\n  if (isApi) return 'api';\n\n  const isBase = url.indexOf('/base-') >= 0;\n  if (isBase) return 'base';\n\n  const isImage = url.indexOf('/icons/') >= 0 || url.indexOf('/splash/') >= 0;\n  if (isImage) return 'image';\n\n  return 'page';\n\n}\n\n\n","\n/* global self */\nimport { log } from './log';\nimport { getRequestType } from './getRequestType';\n\nlet cache;\n\nexport function onFetch(e) {\n\n  const url = e.request.url;\n  const requestType = getRequestType(url);\n  const skipSW = [ 'page', 'api' ].includes(requestType);\n  log('RequestType', requestType);\n\n  if (skipSW) return self.fetch(e.request);\n\n  log('Fetching', url);\n  e.respondWith(\n    self.caches.open(self.cacheName)\n    .then(cache_ => {\n      cache = cache_;\n      return cache.match(e.request);\n    })\n    .then(cachedResponse => {\n      if (cachedResponse) {\n        log('Serving from cache', cachedResponse.url);\n        return cachedResponse;\n      }\n      return self.fetch(e.request);\n    })\n    .then(networkResponse => {\n      e.waitUntil(\n        cache.put(e.request, networkResponse.clone())\n      );\n      return networkResponse;\n    })\n  );\n\n}\n\n\n","\n/* global self */\n\nimport { onInstall } from './onInstall';\nimport { onActivate } from './onActivate';\nimport { onFetch } from './onFetch';\n\nself.cacheName = 'v1';\n\nself.addEventListener('install', onInstall);\nself.addEventListener('activate', onActivate);\nself.addEventListener('fetch', onFetch);\n\n"]}